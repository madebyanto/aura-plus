atsapp">WhatsApp</a>
        <a href="https://t.me/aurastudioita" class="telegram">Telegram</a>
      </div>
    </div>
  </div>

  <!-- Impostazioni -->
  <div id="account-section">
    <div class="account-header">Impostazioni</div>
    <div class="account-options">
      <button onclick="window.location.href='settings.html'">👤 Account</button>
      <button onclick="window.location.href='personalize.html'">🎨 Personalizza</button>
      <button onclick="window.location.href='howtogetbalance.html'">💰 Saldo & Wallet</button>
    </div>
  </div>

  <!-- Nyra Lite -->
  <div id="nyra-lite-section">
    <div class="account-header">✨ Nyra Lite</div>
    <div id="nyra-lite-chat" style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;min-height:200px;max-height:300px;overflow-y:auto;font-family:'Courier New',monospace;color:#fff;"></div>
    <input id="nyra-lite-input" type="text" placeholder="Scrivi un messaggio..." style="width:100%;padding:0.6rem 1rem;border-radius:12px;border:none;font-size:0.9rem;margin-top:0.5rem;">
    <button id="nyra-lite-send" style="margin-top:0.5rem;padding:0.6rem 1rem;border-radius:12px;border:none;background:#f174ff;color:#fff;font-weight:600;cursor:pointer;transition:0.3s;width:100%;">Invia</button>
    <p style="font-size:0.75rem;color:#00c3ff;text-align:center;margin-top:0.5rem;">Vuoi di più? Scarica la versione completa!</p>
  </div>
</main>

<!-- Navbar -->
<div class="navbar">
  <div class="nav-item active" onclick="showSection('dashboard')">🏠</div>
  <div class="nav-item" onclick="showSection('news')">📰</div>
  <div class="nav-item" onclick="showSection('account')">⚙️</div>
  <div class="nav-item" onclick="showSection('nyra-lite')">✨</div>
</div>

<script>
function showSection(section){
  document.getElementById("dashboard-section").style.display="none";
  document.getElementById("news-section").style.display="none";
  document.getElementById("account-section").style.display="none";
  document.getElementById("nyra-lite-section").style.display="none";
  document.querySelectorAll('.nav-item').forEach(el=>el.classList.remove('active'));

  if(section==="dashboard"){
    document.getElementById("dashboard-section").style.display="block";
    document.querySelectorAll('.nav-item')[0].classList.add('active');
  }else if(section==="news"){
    document.getElementById("news-section").style.display="block";
    document.querySelectorAll('.nav-item')[1].classList.add('active');
  }else if(section==="account"){
    document.getElementById("account-section").style.display="block";
    document.querySelectorAll('.nav-item')[2].classList.add('active');
  }else if(section==="nyra-lite"){
    document.getElementById("nyra-lite-section").style.display="block";
    document.querySelectorAll('.nav-item')[3].classList.add('active');
  }
}

// Firebase user data
auth.onAuthStateChanged(user=>{
  if(user){
    db.collection("users").doc(user.uid).get().then(doc=>{
      if(doc.exists){
        const data=doc.data();
        document.getElementById('user-name').childNodes[0].textContent = 
          (data.nome&&data.cognome)?`${data.nome} ${data.cognome} `:"Nome Cognome ";
        document.getElementById('user-email').textContent=" "+user.email;
        document.getElementById('user-uid').textContent="UID: "+user.uid;
        document.getElementById('saldo').textContent=(data.saldo!==undefined)?data.saldo+" €":"0 €";
        document.getElementById('profile-img').src=data.profileImage||'aurastudio.png';
        const bioTextEl=document.getElementById('bio-text');
        const description=(data.bio&&data.bio.description)?data.bio.description:"Nessuna descrizione impostata.";
        let index=0;
        function typeWriter(){if(index<description.length){bioTextEl.textContent+=description.charAt(index);index++;setTimeout(typeWriter,25);}}
        bioTextEl.textContent="";typeWriter();
        document.getElementById('badge').textContent=(data.badge&&data.badge.trim()!=="")?data.badge:"Utente";
      }else{
        db.collection("users").doc(user.uid).set({saldo:15,profileImage:'aurastudio.png',badge:''});
      }
    });
  }else{window.location.href="login.html";}
});

// Nyra Lite chat
const chatContainer = document.getElementById('nyra-lite-chat');
let conversationHistory = [];
async function sendNyraMessage(){
  const input = document.getElementById('nyra-lite-input');
  const message = input.value.trim();
  if(!message) return;
  conversationHistory.push({role:'user', content:message});
  chatContainer.innerHTML += `<div style="margin:0.3rem 0;text-align:right;">👤 ${message}</div>`;
  input.value=''; chatContainer.scrollTop = chatContainer.scrollHeight;
  try {
    const response = await fetch('https://api.nyra.aurastudioitalia.it', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({conversation: conversationHistory})
    });
    const data = await response.json();
    const reply = data.reply || 'Nyra non ha risposto.';
    conversationHistory.push({role:'nyra', content:reply});
    chatContainer.innerHTML += `<div style="margin:0.3rem 0;text-align:left;">✨ ${reply}</div>`;
    chatContainer.scrollTop = chatContainer.scrollHeight;
  } catch(err){
    console.error('Errore Nyra Lite:', err);
    chatContainer.innerHTML += `<div style="margin:0.3rem 0;text-align:left;color:#f00;">Errore di connessione</div>`;
    chatContainer.scrollTop = chatContainer.scrollHeight;
  }
}

document.getElementById('nyra-lite-send').addEventListener('click', sendNyraMessage);
document.getElementById('nyra-lite-input').addEventListener('keydown', e => {if(e.key==='Enter') sendNyraMessage();});
</script>
</body>
</html>